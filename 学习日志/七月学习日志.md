# 7.21
大致配好了groupvit的环境，成功测试了一下它的零样本语义分割效果，其在coco数据集上的测试结果还行，和论文中的结果数据一致，为24.3。我又试了一下遥感的数据集，结果很差，mIoU只有3.53。
**一些经验**：
* 有问题可以多问copilot。
* 这几天也学到不少linux操作指令。
* 安装依赖库的方法途径：官方没有conda安装方式的话，可以去https://anaconda.org/找找看，注意platform要和自己系统匹配（比如linux64），没有完全一致的版本的话，找个最接近的版本（比如项目作者用的是pytorch1.8.0，而https://anaconda.org/里最接近的是pytorch1.8.2，那就用pytorch1.8.2，总比没有好）。
* 下载cuda可以去官网找下载源，有可选项让我选择适配的版本。若只是调用它的第三方库，就下载cudatoolkit就行了，选择runfile(local)，下到所用的虚拟环境下。有些时候需要下到系统级cuda，那会更麻烦了，还没试过。只有系统级的cudatoolkit才可以调用nvcc。
* 可以用 -c 来强制指定conda安装依赖库的channel。
* 使用pip之前可以先用`which pip`查看一下pip的路径，以防用的是别的环境的pip。若真是这样，可以重启终端重新激活环境，这样pip就会变成当下虚拟环境里的pip。

# 7.22
redcaps12m数据集下载好了，下了一个下午+一个晚上才下载好，但是由于cudatoolkit不是系统级的，所以用不了AMP，所以还无法训练。原本下载的是yfcc14m数据集，但是获取不到，需要亚马逊账号，而注册需要信用卡购买服务，我没有信用卡，就放弃了。redcaps12m数据集的下载[(Copy) redcaps_v1.0_annotations.zip](https://www.dropbox.com/preview/\(Copy\)%20redcaps_v1.0_annotations.zip?path=&scs=true)也需要购买服务，不过这个平台可以用paypal免费购买一个月，但是一定要记得在将要结束的时候取消续费。
今天还理解了一遍groupvit模型部分的代码，知道了代码运作流程。明天再看一下数据准备部分的流程，也就是对于数据输入它是怎么处理的，这样我才好适配到遥感领域的数据集来做训练。
善于运用fittencode或其他编辑器ai助手来解释代码，理清项目的代码结构。

# 7.23
没啥进展

# 7.24
修改简化groupvit的代码，让它适配于遥感数据集，明天得到数据集后就可以开始训练了。

# 7.26
使用终端下载东西的时候，尽量把整个终端窗口拉高，不然有些地方没显示出来，会卡住。

配GroundingDINO环境配了半天还没有配好，服了！！！！！！！

明天试试把环境和cuda重装一下吧

要么就先不管环境了，先好好理解一下项目的代码和结构。

# 7.27
尝试Open-GroundingDINO，捣鼓了一整天的环境问题，草，配好环境后发现作者的代码写的有问题，很多要用到的参数在config里都没有写，最后我只能放弃了。

晚上有重新试回GroundingDINO，这次终于可以了，用python setup.py build install运行编译，生成build文件夹，里面的里面有一个_C.so文件，就是最关键的用来作为cuda拓展的文件。而且我发现在gdino虚拟环境中运行nvcc -V也终于可以显示出正确的cuda-11.8这个期望的版本了，原因应该是我在个人文件夹home/hjj/下的.bashrc文件里设好了CUDA_SOME=usr/local/cuda-11.8，且我设置了软链接，将cuda连至cuda-11.8，不过不知道这是否是必要的，我在想我在CUDA_HOME已经明确了版本号，所以可能这个软链接也不是很必要吧。不过我发现一个问题就是，设置软链接后cuda和cuda文件之间循环嵌套了，不知道具体是为什么，可能是我反复多次设置了软链接，并且忘记删除上一次设置的，所以导致循环嵌套了，不过目前没什么影响就是了。

我运行了demo.py，预测了一张猫狗图片的效果，和作者的效果一致。还对coco数据集进行评估，得到了和作者一样的结果。预测了几张遥感图片的效果，还行，但也没有特别准确。

今天还有一个很大的收获就是看到几篇博客，使我对于cuda的安装有了更清晰的认识，并且整理在了[笔记](其他笔记/cuda安装的相关问题与解决方案)里。

# 7.28
今天尝试搞了一下用于适配遥感数据集VRSBench目标检测任务的微调的训练代码。总算是成功跑起来了，看起来也挺有效果的，loss在降，acc在升，iou也在升。但是没时间训练，明天开始正式训练。训练的同时好好理解一下代码的结构。最好是再看一遍论文，理解一下细节再正式训练。

另外，明天记得修改一下最好模型的保存方式，删除原来的，保存新的，同时要有标号。另外把step改一下。还有实现一下训练过程的可视化，以及log日志记录实验过程。还有，学一下断网挂着服务器进程来训练的方法。

# 7.29
按昨天的安排进行训练准备以及一些相关知识的学习。

# 7.30 
完成训练，发现效果很不好。
# 7.31-8.2
回家后有点松懈。

看着极差的微调训练结果，感觉之前写的微调代码感觉有问题，所以这几天返回到别人复现的Ooen-GroundingDINO这个项目，理解它的代码，理解它的逻辑。所以这几天一直在看代码，另外电脑很卡，本地电脑vscode拓展出现问题，无法查看函数和类的定义。所以没有什么进展。不过今天跑通了之前没跑通的opengroundingdino项目，接下来打算在这个 项目的基础上进行修改。已经在GroundingDINO上进行一部分核心代码的理解，所以接下来在opengroundingdino上的尝试应该会比较快。

进一步研究了一下windows下cuda的安装与使用。

一些经验：当出现“无法检测torch的version”这类的报错时，可以直接在报错位置手动设置torch版本来规避这个错误。

一个无法解决的小困难：连接远程服务器的vscode窗口无法实现“crtl+单击”跳转到函数定义位置，也无法检测错误，简单来说就是python扩展无法加载，试过网上的一些方法，但是问题还是没有解决。之前也问过学长，但是学长没遇到这种情况，也不知怎么回事。所以我现在要看代码改代码进行调试和运行，都得先在本地下载同等项目，在本地进行代码逻辑的仔细查看（因为本地可以正常使用python扩展（不过这几天本地的python扩展也很卡，有时得重启电脑几次才能加载出来）），然后在本地先写好代码，确保没有检测出错误后，再复制到服务器，服务器上的运行报错后，再回到本地进行代码的修改。如此循环往复。不太方便。